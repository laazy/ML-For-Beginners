# рд╕реНрдХikit-learn рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдПрдХ Regression рдореЛрдбреЗрд▓ рдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрд╣реЛрд╕реН: regression рдЪрд╛рд░ рддрд░рд┐рдХрд╛рд╣рд░реВ

## рд╢реБрд░реБрд╡рд╛рддреА рдиреЛрдЯ

Linear regression рддрдм рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫ рдЬрдм рд╣рд╛рдореА **рд╕рдЩреНрдЦреНрдпрд╛рддреНрдордХ рдорд╛рди** (рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдШрд░рдХреЛ рдореВрд▓реНрдп, рддрд╛рдкрдХреНрд░рдо, рд╡рд╛ рдмрд┐рдХреНрд░реА) рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рдЪрд╛рд╣рдиреНрдЫреМрдВред
рдпреЛ рдЗрдирдкреБрдЯ рд╕реБрд╡рд┐рдзрд╛рд╣рд░реВ рд░ рдЖрдЙрдЯрдкреБрдЯ рдмрд┐рдЪрдХреЛ рд╕рдореНрдмрдиреНрдзрд▓рд╛рдИ рд╕рдмреИрднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдЧрд░реНрдиреЗ рдПрдХ рд╕рд┐рдзрд╛ рд░реЗрдЦрд╛ рдЦреЛрдЬреЗрд░ рдХрд╛рдо рдЧрд░реНрдЫред

рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА рдЕрдзрд┐рдХ рдЙрдиреНрдирдд regression рдкреНрд░рд╡рд┐рдзрд┐рд╣рд░реВрдХреЛ рдЕрдиреНрд╡реЗрд╖рдг рдЧрд░реНрдиреБ рдЕрдШрд┐ рдЕрд╡рдзрд╛рд░рдгрд╛ рдмреБрдЭреНрдирдорд╛ рдХреЗрдиреНрджреНрд░рд┐рдд рдЫреМрдВред
![Linear vs polynomial regression infographic](../../../../translated_images/ne/linear-polynomial.5523c7cb6576ccab.webp)
> рдЗрдиреНрдлреЛрдЧреНрд░рд╛рдлрд┐рдХ рджреНрд╡рд╛рд░рд╛ [рджрд╛рд╕рд╛рдиреА рдорд╛рдбреАрдкрд╛рд▓реА](https://twitter.com/dasani_decoded)
## [рдкрд╛рда рдЕрдШрд┐ рдХреНрд╡рд┐рдЬ](https://ff-quizzes.netlify.app/en/ml/)

> ### [рдпреЛ рдкрд╛рда R рдорд╛ рдЙрдкрд▓рдмреНрдз рдЫ!](../../../../2-Regression/3-Linear/solution/R/lesson_3.html)
### рдкрд░рд┐рдЪрдп 

рдЕрд╣рд┐рд▓реЗ рд╕рдореНрдо рддрдкрд╛рдИрдВрд▓реЗ regression рдХреЗ рд╣реЛ рднрдиреА рдмреБрдЭреНрдиреБрднрдпреЛ, рд╡рд┐рднрд┐рдиреНрди рдирдореБрдирд╛ рдбреЗрдЯрд╛ рд╕рдВрдЧ рдЬреБрди рд╣рд╛рдореАрд▓реЗ рдпреЛ рдкрд╛рдардорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрдХрд╛ рдЫреМрдВред рддрдкрд╛рдИрдВрд▓реЗ рдпрд╕рд▓рд╛рдИ Matplotlib рдкреНрд░рдпреЛрдЧ рдЧрд░реА рджреГрд╢реНрдпрдорд╛рди рдкрдирд┐ рдмрдирд╛рдЙрдиреБ рднрдПрдХреЛ рдЫред

рдЕрдм рддрдкрд╛рдИрдВ ML рдХрд╛ рд▓рд╛рдЧрд┐ regression рдорд╛ рдЕрдЭ рдЧрд╣рд┐рд░реЛ рд░реВрдкрдорд╛ рдЬрд╛рди рддрдпрд╛рд░ рд╣реБрдиреБрд╣реБрдиреНрдЫред рдЬрдмрдХрд┐ рджреГрд╢реНрдпрд▓реЗ рдбреЗрдЯрд╛ рдмреБрдЭреНрди рдорджреНрджрдд рдЧрд░реНрджрдЫ, рдорд╢реАрди рд▓рд░реНрдирд┐рдЩрдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╢рдХреНрддрд┐ _рдореЛрдбреЗрд▓рд╣рд░реВ рддрд╛рд▓рд┐рдо_ рдорд╛ рд╣реБрдиреНрдЫред рдореЛрдбреЗрд▓рд╣рд░реВ рдЗрддрд┐рд╣рд╛рд╕рдЧрдд рдбрд╛рдЯрд╛рдорд╛ рддрд╛рд▓рд┐рдо рджрд┐рдЗрдиреНрдЫ рддрд╛рдХрд┐ рд╕реНрд╡рддрдГ рдбреЗрдЯрд╛ рдирд┐рд░реНрднрд░рддрд╛рд▓рд╛рдИ рд╕рдорд╛рддреЛрд╕, рд░ рддрдкрд╛рдИрдВрд▓рд╛рдИ рдирдпрд╛рдБ рдбрд╛рдЯрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рджрд┐рдиреНрдЫрдиреН, рдЬреБрди рдореЛрдбреЗрд▓рд▓реЗ рдкрд╣рд┐рд▓реЗ рджреЗрдЦреЗрдХреЛ рдЫреИрдиред

рдпрд╕ рдкрд╛рдардорд╛, рддрдкрд╛рдИрдВ рджреБрдИ рдкреНрд░рдХрд╛рд░рдХрд╛ regression рдмрд╛рд░реЗ рдердк рдЬрд╛рдиреНрдиреБрд╣реБрдиреЗрдЫ: _рдЖрдзрд╛рд░рднреВрдд linear regression_ рд░ _polynomial regression_, рд╕рд╛рдереИ рдпреА рдкреНрд░рд╡рд┐рдзрд┐рд╣рд░реВрдХреЛ рдкреГрд╖реНрдарднреВрдорд┐рдорд╛ рд░рд╣реЗрдХреЛ рдХреЗрд╣реА рдЧрдгрд┐рддред рддреА рдореЛрдбреЗрд▓рд╣рд░реВрд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рд╡рд┐рднрд┐рдиреНрди рдЗрдирдкреБрдЯ рдбрд╛рдЯрд╛рдорд╛ рдЖрдзрд╛рд░рд┐рдд рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдореВрд▓реНрдп рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдиреЗрдЫрдиреНред 

[![ML for beginners - Understanding Linear Regression](https://img.youtube.com/vi/CRxFT8oTDMg/0.jpg)](https://youtu.be/CRxFT8oTDMg "ML for beginners - Understanding Linear Regression")

> ЁЯОе рдорд╛рдерд┐рдХреЛ рдЫрд╡рд┐рдорд╛ рдХреНрд▓рд┐рдХ рдЧрд░реНрдиреБрд╣реЛрд╕реН linear regression рдХреЛ рдЫреЛрдЯреЛ рднрд┐рдбрд┐рдпреЛ рдЕрд╡рд▓реЛрдХрдирдХрд╛ рд▓рд╛рдЧрд┐ред

> рдпрд╕ рдкрд╛рдареНрдпрдХреНрд░рдорд▓реЗ рдиреНрдпреВрдирддрдо рдЧрдгрд┐рддреАрдп рдЬреНрдЮрд╛рди рдорд╛рдирд┐рдиреНрдЫ, рд░ рдЕрдиреНрдп рдХреНрд╖реЗрддреНрд░рдХрд╛ рд╡рд┐рджреНрдпрд╛рд░реНрдереАрд╣рд░реВрдХреЛ рдкрд╣реБрдБрдЪрдпреЛрдЧреНрдп рдмрдирд╛рдЙрди рдЯрд┐рдк, ЁЯзо рдХрд▓рдЖрдЙрдЯ, рдЖрд░реЗрдЦ, рд░ рдЕрдиреНрдп рд╕рд┐рдХрд╛рдЗ рдЙрдкрдХрд░рдгрд╣рд░реВ рджреЗрдЦрд┐рдиреНрдЫрдиреНред

### рдкреВрд░реНрд╡рд╢рд░реНрдд

рдЖрдлреВрд▓реЗ рдЕрд╣рд┐рд▓реЗ рд╕рдореНрдо рд╣реЗрд░реЗрдХреЛ рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рд╕рдБрдЧ рдкрд░рд┐рдЪрд┐рдд рд╣реБрдиреБрд╣реБрдиреНрдЫред рдпреЛ рдкрд╛рдард╕рдБрдЧ рд╕рдореНрдмрджреНрдз _notebook.ipynb_ рдлрд╛рдЗрд▓рдорд╛ рдкреВрд░реНрд╡рд▓реЛрдб рд░ рдкреВрд░реНрд╡рд╕рдлрд╛ рдЧрд░рд┐рдПрдХреЛ рдЫред рдлрд╛рдЗрд▓рдорд╛, рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдореВрд▓реНрдп рдкреНрд░рддрд┐ рдмреБрд╕рд▓ рдирдпрд╛рдБ рдбреЗрдЯрд╛ рдлреНрд░реЗрдордорд╛ рджреЗрдЦрд╛рдЗрдПрдХреЛ рдЫред рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдЧрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ рддрдкрд╛рдИрдВрд▓реЗ рдпреА рдиреЛрдЯрдмреБрдХрд╣рд░реВ Visual Studio Code рдХреЛ рдХрд░реНрдирд▓рд╣рд░реВрдорд╛ рдЪрд▓рд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

### рддрдпрд╛рд░реА

рдПрдХ рд╕рдореНрдЭрдирд╛ рд╕реНрд╡рд░реБрдк, рддрдкрд╛рдИрдВ рдпреЛ рдбреЗрдЯрд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдпрд╕рдмрд╛рд░реЗ рдкреНрд░рд╢реНрдирд╣рд░реВ рд╕реЛрдзреНрди рд▓рд╛рдЧреНрдиреБрднрдПрдХреЛ рдЫред

- рдХрджреНрджреБрдЦреБрд░рд╛ рдХрд╣рд┐рд▓реЗ рдЦрд░реАрдж рдЧрд░реНрдиреБ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫ? 
- рдорд┐рдирд┐рдПрдЪрд░ рдХрджреНрджреБрдЦреБрд░рд╛рд╣рд░реВрдХреЛ рдХреЗрд╕рдХреЛ рдореВрд▓реНрдп рдХрддрд┐ рдЕрдкреЗрдХреНрд╖рд╛ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ?
- рдХреЗ рдо рддрд┐рдиреАрд╣рд░реВ рдЖрдзрд╛-рдмреБрд╕рд▓ рдмрд╛рд╕реНрдХреЗрдЯрдорд╛ рдХрд┐рдиреНрдиреЗ рдХрд┐ 1 1/9 рдмреБрд╕рд▓ рдмрд╛рдХрд╕рдорд╛?

рдпрд╕ рдбреЗрдЯрд╛ рдмреБрдЭреНрди рдЬрд╛рд░реА рд░рд╛рдЦреМрдВред

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардорд╛, рддрдкрд╛рдИрдВрд▓реЗ Pandas рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реА рдореВрд▓ dataset рдХреЛ рдХреЗрд╣реА рднрд╛рдЧ рднрд░реНрдиреБрднрдпреЛ рд░ рдореВрд▓реНрдп рдмреБрд╕рд▓ рджреНрд╡рд╛рд░рд╛ рдорд╛рдирдХреАрдХреГрдд рдЧрд░реНрдиреБрднрдпреЛред рддреНрдпрд╕рд░реА рддрдкрд╛рдИрдВрд▓реЗ рд▓рдЧрднрдЧ рекрежреж рдбреЗрдЯрд╛рдкреНрд╡рд╛рдЗрдиреНрдЯ рдорд╛рддреНрд░ рдЬрдореНрдорд╛ рдЧрд░реНрди рд╕рдХреНрдиреБрднрдпреЛ рд░ рддреА рдкрдирд┐ рд╕рд┐рд░реНрдл рдкрддрдЭрдб рдорд╣рд┐рдирд╛рдХрд╛ рд▓рд╛рдЧрд┐ рдорд╛рддреНрд░ред

рдпрд╕ рдкрд╛рдард╕рдБрдЧ рд╕рдореНрдмрджреНрдз рдиреЛрдЯрдмреБрдХрдорд╛ рдкреВрд░реНрд╡рд▓реЛрдб рдЧрд░рд┐рдПрдХреЛ рдбреЗрдЯрд╛ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рдбреЗрдЯрд╛ рдкреВрд░реНрд╡рд▓реЛрдб рдЧрд░рд┐рдПрдХреЛ рдЫ рд░ рдкреНрд░рд╛рд░рдореНрднрд┐рдХ scatterplot рд▓реЗ рдорд╣рд┐рдирд╛рдХреЛ рдбреЗрдЯрд╛ рджреЗрдЦрд╛рдЙрдБрдЫред рд╕рд╛рдпрдж рдбреЗрдЯрд╛ рд╕рдлрд╛ рдЧрд░реЗрд░ рдпрд╕рдХреЛ рдкреНрд░рдХреГрддрд┐ рдмрд╛рд░реЗ рдердк рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред

## рдПрдХ linear regression рд░реЗрдЦрд╛

рдкрд╛рда рез рдорд╛ рд╕рд┐рдХреЗрдЭреИрдВ, linear regression рдЕрднреНрдпрд╛рд╕рдХреЛ рд▓рдХреНрд╖реНрдп рд░реЗрдЦрд╛ рдкреНрд▓рдЯ рдЧрд░реНрди рд╕рдХреНрд╖рдо рд╣реБрдиреБ рд╣реЛ рдЬрд╕рд▓реЗ:

- **рдЪрд▓ рднреЗрд░рд┐рдпрдмрд▓ рд╕рдореНрдмрдиреНрдз рджреЗрдЦрд╛рдЙрдиреЗ**ред рднреЗрд░рд┐рдпрдмрд▓рд╣рд░реВрдХреЛ рд╕рдореНрдмрдиреНрдз рджреЗрдЦрд╛рдЙрдиреЗ
- **рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрдиреЗ**ред рдирдпрд╛рдБ рдбреЗрдЯрд╛рдкреНрд╡рд╛рдЗрдиреНрдЯ рддреНрдпреЛ рд░реЗрдЦрд╛рдкреНрд░рддрд┐ рдХрд╣рд╛рдБ рдкрд░реНрдиреЗрдЫ рднрдиреНрдиреЗ рд╕рд╣реА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрдиреЗред

рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛ **Least-Squares Regression** рдпрд╕реНрддреЛ рдкреНрд░рдХрд╛рд░рдХреЛ рд░реЗрдЦрд╛ рддрд╛рдиреНрди рдкреНрд░рдпреЛрдЧ рд╣реБрдиреНрдЫред "Least-Squares" рд╢рдмреНрджрд▓реЗ рдореЛрдбреЗрд▓рдХреЛ рдХреБрд▓ рддреНрд░реБрдЯрд┐ рдХрдо рдЧрд░реНрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рд▓рд╛рдИ рдЬрдирд╛рдЙрдБрдЫред рдкреНрд░рддреНрдпреЗрдХ рдбреЗрдЯрд╛рдкреНрд╡рд╛рдЗрдиреНрдЯрдХреЛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрд┐рдиреНрджреБ рд░ regression рд▓рд╛рдЗрди рдмреАрдЪрдХреЛ рдард╛рдбреЛ рджреВрд░реА (residual рднрдирд┐рдиреНрдЫ) рдорд╛рдкрди рдЧрд░реНрдЫреМрдВред

рд╣рд╛рдореА рдпреА рджреВрд░реАрд╣рд░реВрд▓рд╛рдИ рджреБрдИ рдХрд╛рд░рдгрд▓реЗ рд╡рд░реНрдЧ рдЧрд░реНрдирдЫреМрдВ:

1. **рджрд┐рд╢рд╛ рднрдиреНрджрд╛ рдкрд░рд┐рдорд╛рдгрд▓рд╛рдИ рдорд╣рддреНрд╡ рджрд┐рдиреБ:** -рел рдХреЛ рдЧрд▓реНрддреАрд▓рд╛рдИ +рел рдХреЛ рдЧрд▓реНрддреА рдЬрд╕реНрддреИ рд╡реНрдпрд╡рд╣рд╛рд░ рдЧрд░реНрди рдЪрд╛рд╣рдиреНрдЫреМрдВред рд╡рд░реНрдЧ рдЧрд░реНрджрд╛ рд╕рдмреИ рдорд╛рдирд╣рд░реВ рд╕рдХрд░рд╛рддреНрдордХ рд╣реБрдиреНрдЫрдиреНред

2. **рдЕрддреНрдпрдзрд┐рдХ рднрд┐рдиреНрдирддрд╛рд▓рд╛рдИ рджрдгреНрдбрд┐рдд рдЧрд░реНрдиреБ:** рд╡рд░реНрдЧ рдЧрд░реНрджрд╛ рдареВрд▓реЛ рддреНрд░реБрдЯрд┐рд╣рд░реВ рдмрдврд┐ рддреМрд▓ рдкрд╛рдЙрдБрдЫрдиреН, рдЬрд╕рд▓реЗ рд░реЗрдЦрд╛рд▓рд╛рдИ рдЯрд╛рдврд╛ рд░рд╣реЗрдХрд╛ рдмрд┐рдиреНрджреБрд╣рд░реВ рдирдЬрд┐рдХ рд░рд╛рдЦреНрди рдмрд╛рдзреНрдп рдкрд╛рд░реНрдЫред

рддреНрдпрд╕рдкрдЫрд┐ рдпреА рд╕рдмреИ рд╡рд░реНрдЧ рдорд╛рдирд╣рд░реВ рдЬреЛрдбрд┐рдиреНрдЫрдиреНред рд╣рд╛рдореНрд░реЛ рд▓рдХреНрд╖реНрдп рдпреЛ рд░реЗрдЦрд╛ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрдиреБ рд╣реЛ рдЬрд╣рд╛рдБ рдпреЛ рдЕрдиреНрддрд┐рдо рдпреЛрдЧ рд╕рдмреИрднрдиреНрджрд╛ рдХрдо рд╣реБрдиреНрдЫтАФрддреНрдпрд╕реИрд▓реЗ "Least-Squares" рдХреЛ рдирд╛рдоред

> **ЁЯзо рдорд▓рд╛рдИ рдЧрдгрд┐рдд рджреЗрдЦрд╛рдК** 
>
> рдпрд╕ рд░реЗрдЦрд╛рд▓рд╛рдИ, рдЬрд╕рд▓рд╛рдИ _line of best fit_ рднрдирд┐рдиреНрдЫ, [рдПрдХ рд╕рдореАрдХрд░рдг](https://en.wikipedia.org/wiki/Simple_linear_regression) рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрдХреНрдд рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ:
>
> ```
> Y = a + bX
> ```
>
> `X` 'рд╡реНрдпрд╛рдЦреНрдпрд╛рддреНрдордХ рднреЗрд░рд┐рдпрдмрд▓' рд╣реЛред `Y` 'рдЖрд╢реНрд░рд┐рдд рднреЗрд░рд┐рдпрдмрд▓' рд╣реЛред рд░реЗрдЦрд╛рдХреЛ рдврд▓рд╛рди `b` рд╣реЛ рд░ `a` y-intercept рд╣реЛ, рдЬреБрди `X = 0` рд╣реБрдБрджрд╛ `Y` рдХреЛ рдорд╛рди рд╣реЛред
>
>![рдврд▓рд╛рди рдЧрдгрдирд╛](../../../../translated_images/ne/slope.f3c9d5910ddbfcf9.webp)
>
> рдкрд╣рд┐рд▓реЛ, рдврд▓рд╛рди `b` рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдЗрдиреНрдлреЛрдЧреНрд░рд╛рдлрд┐рдХ [рдЬреЗрди рд▓реВрдкрд░](https://twitter.com/jenlooper) рджреНрд╡рд╛рд░рд╛
>
> рдЕрд░реНрдХреЛ рд╢рдмреНрджрдорд╛, рд╣рд╛рдореНрд░реЛ рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдбрд╛рдЯрд╛рдмрд╛рдЯ рдкреНрд░рд╢реНрди рдЧрд░реНрджрд╛: "рдорд╣рд┐рдирд╛ рдЕрдиреБрд╕рд╛рд░ рдкреНрд░рддрд┐ рдмреБрд╕рд▓ рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдореВрд▓реНрдпрдХреЛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА", `X` рдореВрд▓реНрдп рдЬрдирд╛рдЙрдБрдЫ рд░ `Y` рдмрд┐рдХреНрд░реА рдорд╣рд┐рдирд╛ рдЬрдирд╛рдЙрдБрдЫред 
>
>![рд╕рдореАрдХрд░рдг рдкреБрд░рд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН](../../../../translated_images/ne/calculation.a209813050a1ddb1.webp)
>
> Y рдХреЛ рдорд╛рди рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реНред рдпрджрд┐ рддрдкрд╛рдИрдВ рд▓рдЧрднрдЧ $рек рддрд┐рд░реНрджреИ рд╣реБрдиреБрд╣реБрдиреНрдЫ рднрдиреЗ рддреНрдпреЛ рдЕрдкреНрд░рд┐рд▓ рд╣реБрдиреБрдкрд░реНрдЫ! рдЗрдиреНрдлреЛрдЧреНрд░рд╛рдлрд┐рдХ [рдЬреЗрди рд▓реВрдкрд░](https://twitter.com/jenlooper) рджреНрд╡рд╛рд░рд╛
>
> рдЧрдгрд┐рддрд▓реЗ рд░реЗрдЦрд╛рдХреЛ рдврд▓рд╛рди рдкреНрд░рджрд░реНрд╢рди рдЧрд░реНрдиреБрдкрд░реНрдЫ, рдЬреБрди рд╕рдБрдЧ intercept рд▓рд╛рдИ рдкрдирд┐ рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫ, рдЬрд╣рд╛рдБ `X = 0` рд╣реБрдБрджрд╛ `Y` рдХрд╣рд╛рдБ рд╣реБрдиреНрдЫред
>
> рдпреА рдорд╛рдирд╣рд░реВрдХреЛ рдЧрдгрдирд╛ рд╡рд┐рдзрд┐ рддрдкрд╛рдИрдВрд▓реЗ [Math is Fun](https://www.mathsisfun.com/data/least-squares-regression.html) рд╡реЗрдм рд╕рд╛рдЗрдЯрдорд╛ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рдпреЛ [Least-squares рдЧрдгрдХ](https://www.mathsisfun.com/data/least-squares-calculator.html) рдорд╛ рдкрдирд┐ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН рдЬрд╕рд▓реЗ рд╕рдЩреНрдЦреНрдпрд╛рд╣рд░реВрдХреЛ рдорд╛рдирд▓реЗ рд░реЗрдЦрд╛рдорд╛ рдХрд╕рд░реА рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реНрдЫред

## рд╕рд╣рд╕рдВрдмрдиреНрдз

рдЕрдЭ рдПрдХ рдкрдж рдмреБрдЭреНрдиреБрдкрд░реНрдЫ рдЬреБрди рд╣реЛ **рд╕рд╣рд╕рдВрдмрдиреНрдз рдЧреБрдгрд╛рдВрдХ** рджрд┐рдиреЗ X рд░ Y рднреЗрд░рд┐рдпрдмрд▓рд╣рд░реВ рдмреАрдЪред scatterplot рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рддрдкрд╛рдИрдВ рдпрд╕ рдЧреБрдгрд╛рдВрдХрд▓рд╛рдИ рдЫрд┐рдЯреЛ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рдбреЗрдЯрд╛рдкреНрд╡рд╛рдЗрдиреНрдЯрд╣рд░реВ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рд░реЗрдЦрд╛рдорд╛ рдЫрд░рд┐рдПрдХрд╛ рдЫрдиреН рднрдиреЗ рдЙрдЪреНрдЪ рд╕рд╣рд╕рдВрдмрдиреНрдз рд╣реБрдиреНрдЫ, рддрд░ рдпрджрд┐ рдбреЗрдЯрд╛рдкреНрд╡рд╛рдЗрдиреНрдЯрд╣рд░реВ X рд░ Y рдмреАрдЪ рдЬрд╣рд╛рдБрд╕реБрдХреИ рдЫрд░рд┐рдПрдХрд╛ рдЫрдиреН рднрдиреЗ рдХрдо рд╕рд╣рд╕рдВрдмрдиреНрдз рд╣реБрдиреНрдЫред

рдПрдХ рд░рд╛рдореНрд░реЛ linear regression рдореЛрдбреЗрд▓ рддреНрдпрд╕рд▓реЗ рд╣реБрдиреЗрдЫ рдЬрд╕рдХреЛ рд╕рд╣рд╕рдВрдмрдиреНрдз рдЧреБрдгрд╛рдВрдХ рдЙрдЪреНрдЪ (0 рднрдиреНрджрд╛ рдирд┐рдХрдЯ 1) рд╣реБрдиреЗрдЫ рд░ Least-Squares Regression рд╡рд┐рдзрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реА regression рд▓рд╛рдЗрди рд╣реБрдиреЗрдЫред

тЬЕ рдпрд╕ рдкрд╛рдард╕рдБрдЧ рд╕рдореНрдмрджреНрдз рдиреЛрдЯрдмреБрдХ рд╕рдЮреНрдЪрд╛рд▓рди рдЧрд░реА рдорд╣рд┐рдирд╛ рд░ рдореВрд▓реНрдп рдмреАрдЪ scatterplot рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рдХрджреНрджреБрдЦреБрд░рд╛ рдмрд┐рдХреНрд░реАрдХрд╛ рд▓рд╛рдЧрд┐ рдорд╣рд┐рдирд╛ рд░ рдореВрд▓реНрдпрдХреЛ рд╕рдореНрдмрдиреНрдз рддрдкрд╛рдИрдВрдХреЛ scatterplot рджреГрд╢реНрдп рд╡реНрдпрд╛рдЦреНрдпрд╛рдЕрдиреБрд╕рд╛рд░ рдЙрдЪреНрдЪ рд╡рд╛ рдиреНрдпреВрди рд╕рд╣рд╕рдВрдмрдиреНрдз рджреЗрдЦрд╛рдЙрдБрдЫ? рдпрджрд┐ рддрдкрд╛рдИрдВ `рдорд╣рд┐рдирд╛` рд╕рдЯреНрдЯрд╛ *рд╡рд░реНрд╖рдХреЛ рджрд┐рди* (рдЬрд╕реНрддреИ рд╡рд░реНрд╖рдХреЛ рд╢реБрд░реБрджреЗрдЦрд┐ рджрд┐рдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛) рдЬрд╕реНрддрд╛ рдердк рд╕реВрдХреНрд╖реНрдо рдорд╛рдкрди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБ рднрдпреЛ рднрдиреЗ рдХреЗ рддреНрдпреЛ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрдиреНрдЫ?

рддрд▓рдХреЛ рдХреЛрдбрдорд╛, рд╣рд╛рдореАрд▓реЗ рдбреЗрдЯрд╛ рд╕рдлрд╛ рдЧрд░реЗрдХреЛ рд░ `new_pumpkins` рдирд╛рдордХ рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдкреНрд░рд╛рдкреНрдд рдЧрд░реЗрдХреЛ рдорд╛рдиреНрджреИрдЫреМрдВ, рдЬрд╕реНрддреИ:

ID | рдорд╣рд┐рдирд╛ | рд╡рд░реНрд╖рдХреЛ_рджрд┐рди | рднреЗрд░рд╛рдЗрдЯреА | рд╕рд╣рд░ | рдкреНрдпрд╛рдХреЗрдЬ | рдиреНрдпреВрди рдореВрд▓реНрдп | рдЙрдЪреНрдЪ рдореВрд▓реНрдп | рдореВрд▓реНрдп
---|-------|------------|---------|------|---------|------------|------------|-------
70 | 9 | 267 | PIE TYPE | BALTIMORE | 1 1/9 рдмреБрд╕рд▓ рдХрд╛рд░реНрдЯрди | 15.0 | 15.0 | 13.636364
71 | 9 | 267 | PIE TYPE | BALTIMORE | 1 1/9 рдмреБрд╕рд▓ рдХрд╛рд░реНрдЯрди | 18.0 | 18.0 | 16.363636
72 | 10 | 274 | PIE TYPE | BALTIMORE | 1 1/9 рдмреБрд╕рд▓ рдХрд╛рд░реНрдЯрди | 18.0 | 18.0 | 16.363636
73 | 10 | 274 | PIE TYPE | BALTIMORE | 1 1/9 рдмреБрд╕рд▓ рдХрд╛рд░реНрдЯрди | 17.0 | 17.0 | 15.454545
74 | 10 | 281 | PIE TYPE | BALTIMORE | 1 1/9 рдмреБрд╕рд▓ рдХрд╛рд░реНрдЯрди | 15.0 | 15.0 | 13.636364

> рдбреЗрдЯрд╛ рд╕рдлрд╛ рдЧрд░реНрдирдХреЛ рд▓рд╛рдЧрд┐ рдХреЛрдб [`notebook.ipynb`](notebook.ipynb) рдорд╛ рдЙрдкрд▓рдмреНрдз рдЫред рд╣рд╛рдореАрд▓реЗ рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардЬрд╕реНрддреИ рд╕рдлрд╛рдЗ рдХреНрд░рд┐рдпрд╛рдХрд▓рд╛рдкрд╣рд░реВ рдЧрд░реНрдпреМрдВ рд░ `DayOfYear` рд╕реНрддрдореНрдн рддрд▓рдХреЛ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЧрдгрдирд╛ рдЧрд░реНрдпреМрдВ:

```python
day_of_year = pd.to_datetime(pumpkins['Date']).apply(lambda dt: (dt-datetime(dt.year,1,1)).days)
```

рдЕрдм рддрдкрд╛рдИрдВрд▓реЗ linear regression рдкрдЫрд╛рдбрд┐рдХреЛ рдЧрдгрд┐рдд рдмреБрдЭреНрдиреБрднрдпреЛ, рдЖрдЙрдиреБрд╣реЛрд╕реН Regression рдореЛрдбреЗрд▓ рдмрдирд╛рдЙрдБрдЫреМрдВ рдЬрд╕рд▓реЗ рдХреБрди рдХрджреНрджреБрдЦреБрд░рд╛рдХреЛ рдкреНрдпрд╛рдХреЗрдЬрдорд╛ рдЙрддреНрддрдо рдореВрд▓реНрдп рдЖрдЙрдиреЗрдЫ рднрдиреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рд╕рдХреЛрд╕реНред рдХреЛрдИ рдкрдирд┐ рд╡реНрдпрдХреНрддрд┐ рдЬрд╕рд▓реЗ рдкрд░реНрд╡ рдХрджреНрджреБрдЦреБрд░рд╛ рдЦреЗрддреАрдХрд╛ рд▓рд╛рдЧрд┐ рдХрд┐рдиреНрдиреЗрдЫ, рдпреЛ рдЬрд╛рдирдХрд╛рд░реА рдЙрдкрдпреЛрдЧреА рд╣реБрдиреЗрдЫред

## рд╕рд╣рд╕рдВрдмрдиреНрдз рдЦреЛрдЬреНрджреИ

[![ML for beginners - Looking for Correlation: The Key to Linear Regression](https://img.youtube.com/vi/uoRq-lW2eQo/0.jpg)](https://youtu.be/uoRq-lW2eQo "ML for beginners - Looking for Correlation: The Key to Linear Regression")

> ЁЯОе рдорд╛рдерд┐рдХреЛ рдЫрд╡рд┐рдорд╛ рдХреНрд▓рд┐рдХ рдЧрд░реНрдиреБрд╣реЛрд╕реН рд╕рд╣рд╕рдВрдмрдиреНрдзрдХреЛ рдЫреЛрдЯреЛ рднрд┐рдбрд┐рдпреЛ рдЕрд╡рд▓реЛрдХрдирдХрд╛ рд▓рд╛рдЧрд┐ред

рдЕрдШрд┐рд▓реНрд▓реЛ рдкрд╛рдардмрд╛рдЯ рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрдиреБрднрдПрдХреЛ рд╣реЛрд▓рд╛ рдХрд┐ рд╡рд┐рднрд┐рдиреНрди рдорд╣рд┐рдирд╛рд╣рд░реБрдХреЛ рдФрд╕рдд рдореВрд▓реНрдп рдпрд╕рдкреНрд░рдХрд╛рд░ рджреЗрдЦрд┐рдиреНрдЫ:

<img alt="Average price by month" src="../../../../translated_images/ne/barchart.a833ea9194346d76.webp" width="50%"/>

рдпрд╕рд▓реЗ рдХреЗрд╣реА рд╕рд╣рд╕рдВрдмрдиреНрдз рд╣реБрдиреБрдкрд░реНрдЫ рднрдиреНрдиреЗ рд╕рдВрдХреЗрдд рдЧрд░реНрджрдЫ, рд░ рд╣рд╛рдореА `Month` рд░ `Price`, рд╡рд╛ `DayOfYear` рд░ `Price` рдмреАрдЪрдХреЛ рд╕рдореНрдмрдиреНрдз рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЧрд░реНрди linear regression рдореЛрдбреЗрд▓ рддрд╛рд▓рд┐рдо рджрд┐рди рд╕рдХреНрджрдЫреМрдВред рддрд▓ scatter plot рд▓реЗ рдкрдЫрд┐рд▓реНрд▓реЛ рд╕рдореНрдмрдиреНрдз рджреЗрдЦрд╛рдЙрдБрдЫ:

<img alt="Scatter plot of Price vs. Day of Year" src="../../../../translated_images/ne/scatter-dayofyear.bc171c189c9fd553.webp" width="50%" /> 

рдЕрдм `corr` рдлрдВрдХреНрд╢рди рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рд╕рд╣рд╕рдВрдмрдиреНрдз рдЫ рдХрд┐ рдЫреИрди рдЬрд╛рдБрдЪреМрдВ:

```python
print(new_pumpkins['Month'].corr(new_pumpkins['Price']))
print(new_pumpkins['DayOfYear'].corr(new_pumpkins['Price']))
```

рд╕рд╣рд╕рдВрдмрдиреНрдз рдзреЗрд░реИ рдХрдо рджреЗрдЦрд┐рдиреНрдЫ, -0.15 `Month` рджреНрд╡рд╛рд░рд╛ рд░ -0.17 `DayOfMonth` рджреНрд╡рд╛рд░рд╛, рддрд░ рдЕрд░реНрдХреЛ рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рд╕рдореНрдмрдиреНрдз рд╣реБрди рд╕рдХреНрдЫред рднрд┐рдиреНрди-рднрд┐рдиреНрди рдХрджреНрджреБрдЦреБрд░рд╛ рднреЗрд░рд╛рдЗрдЯреАрд╣рд░реВрдХрд╛ рдореВрд▓реНрдп рднрд┐рдиреНрди рдХреНрд▓рд╕реНрдЯрд░рд╣рд░реВ рдЬрд╕реНрддреЛ рджреЗрдЦрд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрдорд╛рдиреА рдкреБрд╖реНрдЯрд┐ рдЧрд░реНрдирдХреЛ рд▓рд╛рдЧрд┐, рдкреНрд░рддреНрдпреЗрдХ рдХрджреНрджреБрдЦреБрд░рд╛ рд╡рд░реНрдЧрд▓рд╛рдИ рднрд┐рдиреНрди рд░рдВрдЧрд▓реЗ рдкреНрд▓рдЯ рдЧрд░реМрдВред `scatter` рдкреНрд▓рдЯрд┐рдЩ рдлрдВрдХреНрд╢рдирд▓рд╛рдИ `ax` рдкреНрдпрд╛рд░рд╛рдорд┐рдЯрд░ рджрд┐рдПрд░ рд╣рд╛рдореА рд╕рдмреИ рдмрд┐рдиреНрджреБрд╣рд░реВ рдПрдЙрдЯреИ рдЧреНрд░рд╛рдлрдорд╛ рд╣рд╛рд▓реНрди рд╕рдХреНрдЫреМрдВ:

```python
ax=None
colors = ['red','blue','green','yellow']
for i,var in enumerate(new_pumpkins['Variety'].unique()):
    df = new_pumpkins[new_pumpkins['Variety']==var]
    ax = df.plot.scatter('DayOfYear','Price',ax=ax,c=colors[i],label=var)
```

<img alt="Scatter plot of Price vs. Day of Year" src="../../../../translated_images/ne/scatter-dayofyear-color.65790faefbb9d54f.webp" width="50%" /> 

рд╣рд╛рдореНрд░реЛ рдЕрдиреБрд╕рдиреНрдзрд╛рдирд▓реЗ рджреЗрдЦрд╛рдЙрдБрдЫ рдХрд┐ рднреЗрд░рд╛рдЗрдЯреАрд▓реЗ рдХреБрд▓ рдореВрд▓реНрдпрдорд╛ рдмрд┐рдХреНрд░реА рдорд┐рддрд┐рд╡рд╛рдЯ рдмрдвреА рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реНрдЫред рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рдмрд╛рд░ рдЧреНрд░рд╛рдлрдмрд╛рдЯ рдкрдирд┐ рджреЗрдЦреНрди рд╕рдХреНрдЫреМрдВ:

```python
new_pumpkins.groupby('Variety')['Price'].mean().plot(kind='bar')
```

<img alt="Bar graph of price vs variety" src="../../../../translated_images/ne/price-by-variety.744a2f9925d9bcb4.webp" width="50%" /> 

рдЕрд╣рд┐рд▓реЗ рдПрдХ рдХрджреНрджреБрдЦреБрд░рд╛ рднреЗрд░рд╛рдЗрдЯреА, 'pie type', рдорд╛ рдорд╛рддреНрд░ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рд░ рдорд┐рддрд┐ рдореВрд▓реНрдпрдорд╛ рдХрд╕реНрддреЛ рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реНрдЫ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН:

```python
pie_pumpkins = new_pumpkins[new_pumpkins['Variety']=='PIE TYPE']
pie_pumpkins.plot.scatter('DayOfYear','Price') 
```
<img alt="Scatter plot of Price vs. Day of Year" src="../../../../translated_images/ne/pie-pumpkins-scatter.d14f9804a53f927e.webp" width="50%" /> 

рдпрджрд┐ рд╣рд╛рдореА рдЕрдм `Price` рд░ `DayOfYear` рдмрд┐рдЪ рд╕рд╣рд╕рдВрдмрдиреНрдз `corr` рдлрдВрдХреНрд╢рдирд▓реЗ рдЧрдгрдирд╛ рдЧрд░реНрдЫреМрдВ рднрдиреЗ `-0.27` рдЬрд╕реНрддреЛ рднреЗрдЯрд┐рдиреНрдЫ - рдЬрд╕рд▓реЗ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЧрд░реНрди рдпреЛрдЧреНрдп рдореЛрдбреЗрд▓ рддрд╛рд▓рд┐рдо рджрд┐рди рд╕реБрдЭрд╛рдЙрдБрдЫред

> linear regression рдореЛрдбреЗрд▓ рддрд╛рд▓рд┐рдо рджрд┐рдиреЗ рдкрд╣рд┐рд▓реЗ рд╣рд╛рдореНрд░реЛ рдбреЗрдЯрд╛ рд╕рдлрд╛ рд╣реБрдиреБ рдкрд░реНрдЫред Linear regression рдЦрд╛рд▓реА рдорд╛рдирд╣рд░реВ рд░ рдорд┐рд╕рд┐рдВрдЧ рдорд╛рдирд╣рд░реВрд╕рдБрдЧ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдХрд╛рдо рдЧрд░реНрджреИрди, рддреНрдпрд╕реИрд▓реЗ рд╕рдмреИ рдЦрд╛рд▓реА рдХреЛрд╢рд╣рд░реВ рд╣рдЯрд╛рдЙрдиреБ рдЙрдЪрд┐рдд рд╣реБрдиреНрдЫ:

```python
pie_pumpkins.dropna(inplace=True)
pie_pumpkins.info()
```

рдЕрд░реНрдХреЛ рддрд░рд┐рдХрд╛ рдд рд╣реЛ рдХрд┐ рддреА рдЦрд╛рд▓реА рдорд╛рдирд╣рд░реВрд▓рд╛рдИ рд╕реЛрд╣реА рд╕реНрддрдореНрднрдХреЛ рдФрд╕рдд рдорд╛рдирд▓реЗ рдкреВрд░реИ рджрд┐рдиреБред

## рд╕рд░рд▓ Linear regression

[![ML for beginners - Linear and Polynomial Regression using Scikit-learn](https://img.youtube.com/vi/e4c_UP2fSjg/0.jpg)](https://youtu.be/e4c_UP2fSjg "ML for beginners - Linear and Polynomial Regression using Scikit-learn")

> ЁЯОе рдорд╛рдерд┐рдХреЛ рдЫрд╡рд┐рдорд╛ рдХреНрд▓рд┐рдХ рдЧрд░реНрдиреБрд╣реЛрд╕реН linear рд░ polynomial regression рдХреЛ рдЫреЛрдЯреЛ рднрд┐рдбрд┐рдпреЛ рдЕрд╡рд▓реЛрдХрдирдХрд╛ рд▓рд╛рдЧрд┐ред

рд╣рд╛рдореНрд░реЛ Linear Regression рдореЛрдбреЗрд▓ рддрд╛рд▓рд┐рдо рджрд┐рди рд╣рд╛рдореА **Scikit-learn** рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВред

```python
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
```

рд╣рд╛рдореА рдЗрдирдкреБрдЯ рдорд╛рдирд╣рд░реВ (рдлрд┐рдЪрд░рд╣рд░реВ) рд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдЖрдЙрдЯрдкреБрдЯ (рд▓реЗрдмрд▓) рдлрд░рдХ numpy array рдорд╛ рдЕрд▓рдЧ рдкрд╛рд░реНрдЫреМрдВ:

```python
X = pie_pumpkins['DayOfYear'].to_numpy().reshape(-1,1)
y = pie_pumpkins['Price']
```

> рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рд▓рд╛рдИ `reshape` рдЧрд░реНрдиреБрдкрд░реНрдпреЛ рддрд╛рдХрд┐ Linear Regression рдкреНрдпрд╛рдХреЗрдЬ рдпрд╕рд▓рд╛рдИ рдареАрдХрд╕рдБрдЧ рдмреБрдЭреНрди рд╕рдХреЛрд╕реНред Linear Regression рд▓реЗ 2D-array рдЗрдирдкреБрдЯ рдЪрд╛рд╣рдиреНрдЫ, рдЬрд╣рд╛рдБ array рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдЗрдирдкреБрдЯ рдлрд┐рдЪрд░рдХреЛ рднреЗрдХреНрдЯрд░ рд╣реБрдиреНрдЫред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рдПрдХ рдорд╛рддреНрд░ рдЗрдирдкреБрдЯ рдЫ - рддреНрдпрд╕реИрд▓реЗ N├Ч1 рдЖрдХрд╛рд░рдХреЛ array рдЪрд╛рд╣рд┐рдиреНрдЫ, рдЬрд╣рд╛рдБ N dataset рдХреЛ рдЖрдХрд╛рд░ рд╣реЛред

рддреНрдпрд╕рдкрдЫрд┐, рд╣рд╛рдореА рдбрд╛рдЯрд╛рд▓рд╛рдИ рддрд╛рд▓рд┐рдо рд░ рдкрд░реАрдХреНрд╖рдгрдХреЛ рд▓рд╛рдЧрд┐ рджреБрдИ рднрд╛рдЧрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ рддрд╛рдХрд┐ рддрд╛рд▓рд┐рдо рдкрдЫрд┐ рдореЛрдбреЗрд▓рд▓рд╛рдИ рдорд╛рдиреНрдп рдЧрд░реНрди рд╕рдХрд┐рдпреЛрд╕реН:

```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

рдЕрдиреНрддрдорд╛, Linear Regression рдореЛрдбреЗрд▓рдХреЛ рддрд╛рд▓рд┐рдо рд▓рд┐рди рджреБрдИ рдкрдВрдХреНрддрд┐рд╣рд░реВ рдорд╛рддреНрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реБрдиреНрдЫред рд╣рд╛рдореА `LinearRegression` рд╡рд╕реНрддреБ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрд░реНрдЫреМрдВ, рд░ `fit` рд╡рд┐рдзрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдпрд╕рд▓рд╛рдИ рдбрд╛рдЯрд╛рдорд╛ рдлрд┐рдЯ рдЧрд░реНрдЫреМрдВ:

```python
lin_reg = LinearRegression()
lin_reg.fit(X_train,y_train)
```

`fit` рдЧрд░реЗрдкрдЫрд┐ `LinearRegression` рд╡рд╕реНрддреБ regresssion рдХрд╛ рд╕рдмреИ coefficients рд░рд╛рдЦреНрдЫ, рдЬреБрди `.coef_` рдкреНрд░реЛрдкрд░реНрдЯреА рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкрд╣реБрдБрдЪ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред рд╣рд╛рдореНрд░рд╛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рддреНрдпрд╣рд╛рдБ рдПрдЙрдЯрд╛ рдорд╛рддреНрд░ coefficient рдЫ, рдЬреБрди рдХрд░реАрд╡ `-0.017` рд╣реБрдиреБрдкрд░реНрдЫред рдпрд╕рдХреЛ рдорддрд▓рдм рдореВрд▓реНрдпрд╣рд░реВ рд╕рдордпрд╕рдБрдЧ рдЕрд▓рд┐рдХрддрд┐ рдШрдЯреНрдиреЗ рджреЗрдЦрд┐рдиреНрдЫ, рддрд░ рдзреЗрд░реИ рд╣реЛрдЗрди, рджреИрдирд┐рдХ рд▓рдЧрднрдЧ 2 рд╕реЗрдиреНрдЯред рд╣рд╛рдореА regresssion рдХреЛ Y-рдЕрдХреНрд╖рд╕рдВрдЧрдХреЛ intersection point `lin_reg.intercept_` рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкрдирд┐ рдкрд╣реБрдБрдЪ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ - рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдпреЛ рдХрд░реАрдм `21` рд╣реБрдиреЗрдЫ, рдЬреБрди рд╡рд░реНрд╖рдХреЛ рд╕реБрд░реБрдореИ рдореВрд▓реНрдп рдЬрдирд╛рдЙрдБрдЫред

рд╣рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓ рдХрддрд┐ рд╢реБрджреНрдз рдЫ рднрдиреА рд╣реЗрд░реНрдирдХреЛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореА рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛рд╕реЗрдЯрдорд╛ рдореВрд▓реНрдпрд╣рд░реВ рдЕрдиреБрдорд╛рди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рд╣рд╛рдореНрд░рд╛ рдЕрдиреБрдорд╛рдирд╣рд░реВ рдЕрдкреЗрдХреНрд╖рд┐рдд рдореВрд▓реНрдпрд╣рд░реВрд╕рдВрдЧ рдХрддрд┐ рдирдЬрд┐рдХ рдЫрдиреН рдорд╛рдкрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдпреЛ mean square error (MSE) рдореЗрдЯреНрд░рд┐рдХ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ, рдЬреБрди рдЕрдкреЗрдХреНрд╖рд┐рдд рд░ рдЕрдиреБрдорд╛рдирд┐рдд рдореВрд▓реНрдпрд╣рд░реВ рдмреАрдЪрдХреЛ рд╕рдмреИ рд╡рд░реНрдЧрдпреБрдХреНрдд рднрд┐рдиреНрдирддрд╛рд╣рд░реВрдХреЛ рдФрд╕рдд рд╣реЛред

```python
pred = lin_reg.predict(X_test)

mse = np.sqrt(mean_squared_error(y_test,pred))
print(f'Mean error: {mse:3.3} ({mse/np.mean(pred)*100:3.3}%)')
```

рд╣рд╛рдореНрд░реЛ рддреНрд░реБрдЯрд┐ рдХрд░реАрд╡ 2 points рдЫ, рдЬреБрди рд▓рдЧрднрдЧ 17% рд╣реЛред рддреНрдпрддрд┐ рд░рд╛рдореНрд░реЛ рдЫреИрдиред рдореЛрдбреЗрд▓ рдЧреБрдгрд╕реНрддрд░рдХреЛ рдЕрд░реНрдХреЛ рд╕рдВрдХреЗрддрдХ рд╣реЛ **coefficient of determination**, рдЬреБрди рдпрд╕рд░реА рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ:

```python
score = lin_reg.score(X_train,y_train)
print('Model determination: ', score)
```
рдпрджрд┐ рдорд╛рди 0 рд╣реЛ рднрдиреЗ, рдпрд╕рдХреЛ рдЕрд░реНрде рдореЛрдбреЗрд▓ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛рд▓рд╛рдИ рдзреНрдпрд╛рди рджрд┐рдБрджреИрди, рд░ *worst linear predictor* рдХреЛ рд░реВрдкрдорд╛ рдХрд╛рд░реНрдп рдЧрд░реНрдЫ, рдЬреБрди рдХреЗрд╡рд▓ рдкрд░рд┐рдгрд╛рдордХреЛ рдФрд╕рдд рдорд╛рди рд╣реЛред рдорд╛рди 1 рдХреЛ рдЕрд░реНрде рд╣рд╛рдореА рд╕рдмреИ рдЕрдкреЗрдХреНрд╖рд┐рдд рдЖрдЙрдЯрдкреБрдЯрд▓рд╛рдИ рдкреВрд░реНрдг рд░реВрдкрдорд╛ рдЕрдиреБрдорд╛рди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рд╣рд╛рдореНрд░рд╛ рдЕрд╡рд╕реНрдерд╛рдорд╛, coefficient рд▓рдЧрднрдЧ 0.06 рдЫ, рдЬреБрди рдзреЗрд░реИ рдХрдо рд╣реЛред

рд╣рд╛рдореА рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛рд▓рд╛рдИ regresssion рд▓рд╛рдЗрдирд╕рдБрдЧреИ рдкреНрд▓рдЯ рдЧрд░реЗрд░ рдкрдирд┐ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рд╣реЗрд░реНрди рд╕рдХреНрдЫреМрдВ рдХрд┐ regresssion рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ:

```python
plt.scatter(X_test,y_test)
plt.plot(X_test,pred)
```

<img alt="Linear regression" src="../../../../translated_images/ne/linear-results.f7c3552c85b0ed1c.webp" width="50%" />

## Polynomial Regression

рдЕрд░реНрдХреЛ рдкреНрд░рдХрд╛рд░рдХреЛ Linear Regression рд╣реЛ Polynomial Regressionред рдХрддрд┐рдкрдп рдЕрд╡рд╕реНрдерд╛рдорд╛ рдЪрд░рд╣рд░реВрдмреАрдЪ рд░реЗрдЦреАрдп рд╕рдореНрдмрдиреНрдз рд╣реБрдиреНрдЫ - рднреЛрд▓реНрдпреБрдо рдЕрдиреБрд╕рд╛рд░ рдХрджреНрджреВ рдЬрддрд┐ рдареВрд▓реЛ рд╣реБрдиреНрдЫ, рдореВрд▓реНрдп рдЙрддрд┐ рдиреИ рдмрдвреА рд╣реБрдиреНрдЫ - рддрд░ рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдВ рдпреА рд╕рдореНрдмрдиреНрдзрд╣рд░реВ рд╕рд┐рдзрд╛ рд░реЗрдЦрд╛ рд╡рд╛ рддрд▓рдХреЛ рд╕рддрд╣рдХреЛ рд░реВрдкрдорд╛ рджреЗрдЦрд╛рдЙрди рд╕рдХрд┐рдВрджреИрдиред

тЬЕ рдпрд╣рд╛рдБ [рдЕрд░реБ рдХреЗрд╣реА рдЙрджрд╛рд╣рд░рдгрд╣рд░реВ](https://online.stat.psu.edu/stat501/lesson/9/9.8) рдЫрдиреН, рдЬрд╕рдорд╛ Polynomial Regression рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред

Date рд░ Price рдмреАрдЪрдХреЛ рд╕рдореНрдмрдиреНрдзрд▓рд╛рдИ рдкреБрдирдГ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реНред рдХреЗ рдпреЛ scatterplot рдЕрд╡рд╢реНрдп рдкрдирд┐ рд╕рд┐рдзрд╛ рд░реЗрдЦрд╛рд▓реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЧрд░рд┐рдиреБрдкрд░реНрдЫ рдЬрд╕реНрддреЛ рджреЗрдЦрд┐рдиреНрдЫ? рдХреА рдореВрд▓реНрдпрд╣рд░реВ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрди рд╕рдХреНрджреИрдирдиреН? рдпрд╕ рдЕрд╡рд╕реНрдерд╛рдорд╛, рддрдкрд╛рдИрдВ polynomial regression рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

тЬЕ Polynomials рддрд┐рдиреАрд╣рд░реВ рдЧрдгрд┐рддреАрдп рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рд╣рд░реВ рд╣реБрдиреН рдЬрд╕рд▓реЗ рдПрдХ рд╡рд╛ рдмрдвреА рдЪрд░рд╣рд░реВ рд░ coefficients рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрди рд╕рдХреНрдЫред

Polynomial regression рд▓реЗ рд╡рдХреНрд░ рд░реЗрдЦрд╛ рдмрдирд╛рдЙрдБрдЫ рдЬрд╕рд▓реЗ рдЧреИрд░-рд░реЗрдЦреАрдп рдбреЗрдЯрд╛ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдлрд┐рдЯ рдЧрд░реНрдЫред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛рдорд╛ squared `DayOfYear` рдЪрд░ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдпреМрдВ рднрдиреЗ, рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ рдбреЗрдЯрд╛рд▓рд╛рдИ рдПрдХ рдкрд░рд╛рдмреЛрд▓рд┐рдХ рд╡рдХреНрд░рд╕рдБрдЧ рдлрд┐рдЯ рдЧрд░реНрди рд╕рдХреНрд╖рдо рд╣реБрдиреЗрдЫреМрдВ, рдЬрд╕рдХреЛ рдиреНрдпреВрдирддрдо рд╡рд░реНрд╖рднрд┐рддреНрд░ рдХреБрдиреИ рдирд┐рд╢реНрдЪрд┐рдд рдмрд┐рдиреНрджреБрдорд╛ рд╣реБрдиреЗрдЫред

Scikit-learn рдорд╛ рдЙрдкрдпреЛрдЧреА [pipeline API](https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html?highlight=pipeline#sklearn.pipeline.make_pipeline) рд╕рдорд╛рд╡реЗрд╢ рдЫ рдЬреБрди рдбрд╛рдЯрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧрд░реНрдиреЗ рдлрд░рдХ рдЪрд░рдгрд╣рд░реВрд▓рд╛рдИ рдЬреЛрдбреНрди рдкреНрд░рдпреЛрдЧ рд╣реБрдиреНрдЫред **pipeline** рднрдиреЗрдХреЛ рдзреЗрд░реИ **estimators** рдХреЛ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реЛред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, рд╣рд╛рдореА рдпрд╕реНрддреЛ pipeline рдмрдирд╛рдЙрдБрдЫреМрдВ рдЬрд╕рд▓реЗ рдкрд╣рд┐рд▓реЗ polynomial features рдореЛрдбреЗрд▓рдорд╛ рдердкреНрдЫ, рдЕрдирд┐ regresssion рддрд╛рд▓рд┐рдо рджрд┐рдиреНрдЫ:

```python
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import make_pipeline

pipeline = make_pipeline(PolynomialFeatures(2), LinearRegression())

pipeline.fit(X_train,y_train)
```

`PolynomialFeatures(2)` рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдирд╛рд▓реЗ рд╣рд╛рдореА рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛рдмрд╛рдЯ рд╕рдмреИ рджреЛрд╕реНрд░реЛ-рд╢реНрд░реЗрдгреА polynomial рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдЫреМрдВред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛ рдпрд╕рд▓реЗ рдорд╛рддреНрд░ `DayOfYear`┬▓ рдорддрд▓рдм рджрд┐рдиреНрдЫ, рддрд░ рджреБрдИ рдЗрдирдкреБрдЯ рдЪрд░ X рд░ Y рднрдПрдорд╛ рдпрд╕рд▓реЗ X┬▓, XY рд░ Y┬▓ рдердкреНрдЫред рд╣рд╛рдореА рдЙрдЪреНрдЪрддрдо рдбрд┐рдЧреНрд░реА polynomial рдкрдирд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред

Pipelines рдореВрд▓ `LinearRegression` рд╡рд╕реНрддреБ рдЬрд╕реНрддреИ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ, рдЕрд░реНрдерд╛рддреН рд╣рд╛рдореА pipeline рд▓рд╛рдИ `fit` рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рдЕрдирд┐ `predict` рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкрд░рд┐рдгрд╛рдо рдкрд╛рдЙрди рд╕рдХреНрдЫреМрдВред рдпреЛ рдЧреНрд░рд╛рдлрд▓реЗ рдкрд░реАрдХреНрд╖рдг рдбрд╛рдЯрд╛ рд░ рдирдЬрд┐рдХрдХреЛ рд╡рдХреНрд░ рджреЗрдЦрд╛рдЙрдБрдЫ:

<img alt="Polynomial regression" src="../../../../translated_images/ne/poly-results.ee587348f0f1f60b.webp" width="50%" />

Polynomial Regression рдХреЛ рдкреНрд░рдпреЛрдЧрд▓реЗ рд╣рд╛рдореА рд╕рдБрдзреИ рдЕрд▓рд┐ рдХрдо MSE рд░ рдмрдвреА determination рдкрд╛рдЙрди рд╕рдХреНрдЫреМрдВ, рддрд░ рддреНрдпрддрд┐ рдзреЗрд░реИ рд╣реБрдБрджреИрдиред рд╣рд╛рдореАрд▓реЗ рдЕрд░реБ features рдкрдирд┐ рдзреНрдпрд╛рди рджрд┐рдиреБ рдкрд░реНрдЫ!

> рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрдиреБрднрдпреЛ рд╣реЛрд▓рд╛ рдХрд┐ рдиреНрдпреВрдирддрдо рдХрджреНрджреВ рдореВрд▓реНрдпрд╣рд░реВ рд▓рдЧрднрдЧ Halloween рдХрд╛ рдЖрд╕рдкрд╛рд╕ рдЕрд╡рд▓реЛрдХрди рдЧрд░рд┐рдиреНрдЫред рдпрд╕рд▓рд╛рдИ рдХрд╕рд░реА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ?

ЁЯОГ рдмрдзрд╛рдИ рдЫ, рддрдкрд╛рдИрдВрд▓реЗ рдпрд╕реНрддреЛ рдореЛрдбреЗрд▓ рдмрдирд╛рдЙрдиреБ рднрдпреЛ рдЬрд╕рд▓реЗ pie pumpkins рдХреЛ рдореВрд▓реНрдп рдЕрдиреБрдорд╛рди рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрджрдЫред рддрдкрд╛рдИрдВ рд╕рдореНрднрд╡рддрдГ рдпрд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдмреИ рдХрджреНрджреВ рдкреНрд░рдХрд╛рд░рдХреЛ рд▓рд╛рдЧрд┐ рджреЛрд╣реЛрд░реНрдпрд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рддрд░ рддреНрдпреЛ рдХрд╛рдо рдердХрд╛рдЙ рд╣реБрдиреЗрдЫред рдЕрдм рд╣рд╛рдореА рд╕рд┐рдХреМрдВ рдХрд╕рд░реА рд╣рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓рдорд╛ рдХрджреНрджреВрдХреЛ рднрд┐рдиреНрдирддрд╛ рд▓рд┐рди рд╕рдХрд┐рдиреНрдЫ!

## Categorical Features

рд╕рдкрдирд╛рдХреЛ рд╕рдВрд╕рд╛рд░рдорд╛, рд╣рд╛рдореАрд▓реЗ рдПрдЙрдЯреИ рдореЛрдбреЗрд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдлрд░рдХ рдлрд░рдХ рдХрджреНрджреВ рднреЗрд░рд╛рдЗрдЯреАрд╣рд░реВрдХреЛ рдореВрд▓реНрдп рдЕрдиреБрдорд╛рди рдЧрд░реНрди рдЪрд╛рд╣рдиреНрдЫреМрдВред рддрд░ `Variety` рд╕реНрддрдореНрдн `Month` рдЬрд╕реНрддрд╛ рд╕реНрддрдореНрднрд╣рд░реВ рдЬрд╕реНрддреИ рдЫреИрди, рдХрд┐рдирдХрд┐ рдпрд╕рд▓реЗ рдЧреИрд░-рд╕рд╛рдВрдЦреНрдпрд┐рдХ рдорд╛рдирд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрджрдЫрдиреНред рдпрд╕реНрддрд╛ рд╕реНрддрдореНрднрд╣рд░реВрд▓рд╛рдИ **categorical** рднрдирд┐рдиреНрдЫред

[![ML for beginners - Categorical Feature Predictions with Linear Regression](https://img.youtube.com/vi/DYGliioIAE0/0.jpg)](https://youtu.be/DYGliioIAE0 "ML for beginners - Categorical Feature Predictions with Linear Regression")

> ЁЯОе рдорд╛рдерд┐рдХреЛ рдЫрд╡рд┐ рдХреНрд▓рд┐рдХ рдЧрд░реЗрд░ categorical features рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рдЫреЛрдЯреЛ рднрд┐рдбрд┐рдпреЛ рд╣реЗрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

рдпрд╣рд╛рдБ рддрдкрд╛рдИрдВрд▓реЗ рджреЗрдЦреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ рдХрд┐ рдФрд╕рдд рдореВрд▓реНрдп рднреЗрд░рд╛рдЗрдЯреАрдорд╛ рдХрд╕рд░реА рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫ:

<img alt="Average price by variety" src="../../../../translated_images/ne/price-by-variety.744a2f9925d9bcb4.webp" width="50%" />

рднреЗрд░рд╛рдЗрдЯреАрд▓рд╛рдИ рдзреНрдпрд╛рдирдорд╛ рд▓рд┐рди, рдкрд╣рд┐рд▓реЗ рд╣рд╛рдореАрд▓реЗ рдпрд╕рд▓рд╛рдИ рд╕рд╛рдВрдЦреНрдпрд┐рдХ рдорд╛рдирдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрдиреБрдкрд░реНрдЫ, рд╡рд╛ **encode** рдЧрд░реНрдиреБрдкрд░реНрдЫред рдпрд╕рдХрд╛ рдХреЗрд╣реА рддрд░рд┐рдХрд╛рд╣рд░реВ рдЫрдиреН:

* рд╕рд╛рдзрд╛рд░рдг **numeric encoding** рд▓реЗ рд╡рд┐рднрд┐рдиреНрди рднреЗрд░рд╛рдЗрдЯреАрд╣рд░реВрдХреЛ рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдЙрдиреЗрдЫ, рд░ рддреНрдпрд╕рдкрдЫрд┐ рднреЗрд░рд╛рдЗрдЯреА рдирд╛рдорд▓рд╛рдИ рддрд╛рд▓рд┐рдХрд╛рдорд╛ рд░рд╣реЗрдХреЛ index рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдЧрд░реНрдиреЗрдЫред рдпреЛ linear regression рдХрд╛ рд▓рд╛рдЧрд┐ рдЙрддреНрддрдо рд╣реЛрдЗрди, рдХрд┐рдирдХрд┐ linear regression рд▓реЗ рд╡рд╛рд╕реНрддрд╡рдорд╛ index рдХреЛ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдорд╛рди рд▓рд┐рдиреНрдЫ рд░ рдкрд░рд┐рдгрд╛рдордорд╛ рдпрд╕рд▓рд╛рдИ рдХреЗрд╣реА coefficient рджреНрд╡рд╛рд░рд╛ рдЧреБрдгрд╛ рдЧрд░реЗрд░ рдердкреНрдЫред рд╣рд╛рдореНрд░реЛ рдЕрд╡рд╕реНрдерд╛рдорд╛, index рдирдореНрдмрд░ рд░ рдореВрд▓реНрдп рдмреАрдЪрдХреЛ рд╕рдореНрдмрдиреНрдз рд╕реНрдкрд╖реНрдЯ рд░реВрдкрдорд╛ рдЧреИрд░-рд░реЗрдЦреАрдп рдЫ, рдпрд╣рд╛рдБрд╕рдореНрдо рдХрд┐ рдпрджрд┐ рд╣рд╛рдореАрд▓реЗ indices рд▓рд╛рдИ рдХреБрдиреИ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рдордорд╛ рд░рд╛рдЦреНрдпреМрдВ рднрдиреЗ рдкрдирд┐ред
* **One-hot encoding** рд▓реЗ `Variety` рд╕реНрддрдореНрднрд▓рд╛рдИ 4 рдлрд░рдХ рд╕реНрддрдореНрднрд╣рд░реВрдорд╛ рдмрджрд▓реНрдиреЗрдЫ, рдкреНрд░рддреНрдпреЗрдХ рднреЗрд░рд╛рдЗрдЯреАрдХрд╛ рд▓рд╛рдЧрд┐ рдПрдЙрдЯреИред рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрдореНрднрдорд╛ `1` рд╣реБрдиреЗрдЫ рдпрджрд┐ рддреНрдпреЛ рдкрдЩреНрдХреНрддрд┐ рдЙрдХреНрдд рднреЗрд░рд╛рдЗрдЯреАрдХреЛ рд╣реЛ, рдирддреНрд░ `0`ред рдпрд╕рдХреЛ рдорддрд▓рдм regresssion рдорд╛ рдЪрд╛рд░ рд╡рдЯрд╛ coefficients рд╣реБрдиреЗрдЫрдиреН, рдкреНрд░рддреНрдпреЗрдХ рдХрджреНрджреВ рднреЗрд░рд╛рдЗрдЯреАрдХреЛ рд▓рд╛рдЧрд┐, рдЬреБрди рдЙрдХреНрдд рднреЗрд░рд╛рдЗрдЯреАрдХрд╛ рд▓рд╛рдЧрд┐ "рд╢реБрд░реБрдорд╛ рдореВрд▓реНрдп" (рд╡рд╛ "рдердк рдореВрд▓реНрдп") рдХреЛ рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рд╣реБрдиреЗрдЫред

рддрд▓рдХреЛ рдХреЛрдбрд▓реЗ рдХрд╕рд░реА variety рд▓рд╛рдИ one-hot encode рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ рджреЗрдЦрд╛рдЙрдБрдЫ:

```python
pd.get_dummies(new_pumpkins['Variety'])
```

 ID | FAIRYTALE | MINIATURE | MIXED HEIRLOOM VARIETIES | PIE TYPE
----|-----------|-----------|--------------------------|----------
70 | 0 | 0 | 0 | 1
71 | 0 | 0 | 0 | 1
... | ... | ... | ... | ...
1738 | 0 | 1 | 0 | 0
1739 | 0 | 1 | 0 | 0
1740 | 0 | 1 | 0 | 0
1741 | 0 | 1 | 0 | 0
1742 | 0 | 1 | 0 | 0

one-hot encoded variety рд▓рд╛рдИ рдЗрдирдкреБрдЯ рдмрдирд╛рдПрд░ linear regression рддрд╛рд▓рд┐рдо рджрд┐рди, рд╣рд╛рдореАрд▓реЗ рд╕рд╣реА рддрд░рд┐рдХрд╛рд▓реЗ `X` рд░ `y` рдбреЗрдЯрд╛ initialize рдЧрд░реНрдиреБрдкрд░реНрдЫ:

```python
X = pd.get_dummies(new_pumpkins['Variety'])
y = new_pumpkins['Price']
```

рдмрд╛рдХреА рдХреЛрдб рднрдиреЗрдХреЛ Linear Regression рддрд╛рд▓рд┐рдо рджрд┐рди рдорд╛рдерд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдПрдХреЛ рдХреЛ рд╕рдВрдЧ рдиреИ рдЫред рдпрджрд┐ рддрдкрд╛рдИрдВ рдкреНрд░рдпрд╛рд╕ рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ рднрдиреЗ, mean squared error рд▓рдЧрднрдЧ рдЙрд╕реНрддреИ рд╣реБрдиреЗ рджреЗрдЦреНрдиреБрд╣реБрдиреЗрдЫ, рддрд░ рд╣рд╛рдореА рдзреЗрд░реИ рдЙрдЪреНрдЪ coefficient of determination (~77%) рдкрд╛рдЙрдБрдЫреМрдВред рдЕрдЭ рд╢реБрджреНрдз рдЕрдиреБрдорд╛рди рдкрд╛рдЙрдирдХрд╛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореА рдзреЗрд░реИ categorical features рд░ рд╕рд╛рдереИ рд╕рд╛рдВрдЦреНрдпрд┐рдХ features рдЬрд╕реНрддреИ `Month` рд╡рд╛ `DayOfYear` рд▓рд╛рдИ рдкрдирд┐ рд╡рд┐рдЪрд╛рд░ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдПрдЙрдЯрд╛ рдареВрд▓реЛ array рдмрдирд╛рдЙрдирдХрд╛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА `join` рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ:

```python
X = pd.get_dummies(new_pumpkins['Variety']) \
        .join(new_pumpkins['Month']) \
        .join(pd.get_dummies(new_pumpkins['City'])) \
        .join(pd.get_dummies(new_pumpkins['Package']))
y = new_pumpkins['Price']
```

рдпрд╣рд╛рдБ рд╣рд╛рдореАрд▓реЗ `City` рд░ `Package` type рдкрдирд┐ рдзреНрдпрд╛рдирдорд╛ рд░рд╛рдЦреЗрдХрд╛ рдЫреМрдВ, рдЬрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ MSE 2.84 (10%) рд░ determination 0.94 рджрд┐рдиреНрдЫ!

## рд╕рдмреИрд▓рд╛рдИ рдорд┐рд▓рд╛рдПрд░

рд╕рдмреИ рднрдиреНрджрд╛ рд░рд╛рдореНрд░реЛ рдореЛрдбреЗрд▓ рдмрдирд╛рдЙрди, рд╣рд╛рдореА рдорд╛рдерд┐рдХреЛ рдЙрджрд╛рд╣рд░рдгрдХреЛ рд╕рдВрдпреБрдХреНрдд (one-hot encoded categorical + numeric) рдбреЗрдЯрд╛ рд░ Polynomial Regression рдПрдХрд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рддрдкрд╛рдИрдВрдХреЛ рд╕рд╣реВрд▓рд┐рдпрддрдХрд╛ рд▓рд╛рдЧрд┐ рдкреВрд░реНрдг рдХреЛрдб рдпрд╣рд╛рдБ рдЫ:

```python
# рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛рд▓рд╛рдИ рд╕реЗрдЯ рдЕрдк рдЧрд░реНрдиреБрд╣реЛрд╕реН
X = pd.get_dummies(new_pumpkins['Variety']) \
        .join(new_pumpkins['Month']) \
        .join(pd.get_dummies(new_pumpkins['City'])) \
        .join(pd.get_dummies(new_pumpkins['Package']))
y = new_pumpkins['Price']

# рдкреНрд░рд╢рд┐рдХреНрд╖рдг-рдЯреЗрд╕реНрдЯ рд╡рд┐рднрд╛рдЬрди рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

# рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╕реЗрдЯрдЕрдк рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЧрд░реНрдиреБрд╣реЛрд╕реН
pipeline = make_pipeline(PolynomialFeatures(2), LinearRegression())
pipeline.fit(X_train,y_train)

# рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рдкрд░рд┐рдгрд╛рдорд╣рд░реВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЧрд░реНрдиреБрд╣реЛрд╕реН
pred = pipeline.predict(X_test)

# MSE рд░ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрдгрдирд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН
mse = np.sqrt(mean_squared_error(y_test,pred))
print(f'Mean error: {mse:3.3} ({mse/np.mean(pred)*100:3.3}%)')

score = pipeline.score(X_train,y_train)
print('Model determination: ', score)
```

рдпрд╕рд▓реЗ рд╣рд╛рдореАрд▓рд╛рдИ рд▓рдЧрднрдЧ 97% рдирд┐рд░реНрдзрд╛рд░рдг coefficient рд░ MSE=2.23 (~8% рдЕрдиреБрдорд╛рди рддреНрд░реБрдЯрд┐) рджрд┐рдиреЗрдЫред

| рдореЛрдбреЗрд▓ | MSE | рдирд┐рд░реНрдзрд╛рд░рдг |
|-------|-----|---------------|
| `DayOfYear` Linear | 2.77 (17.2%) | 0.07 |
| `DayOfYear` Polynomial | 2.73 (17.0%) | 0.08 |
| `Variety` Linear | 5.24 (19.7%) | 0.77 |
| рд╕рдмреИ features Linear | 2.84 (10.5%) | 0.94 |
| рд╕рдмреИ features Polynomial | 2.23 (8.25%) | 0.97 |

ЁЯПЖ рд░рд╛рдореНрд░реЛ рдХрд╛рдо! рддрдкрд╛рдИрдВрд▓реЗ рдПрдЙрдЯрд╛ рдкрд╛рдардорд╛ рдЪрд╛рд░ Regression рдореЛрдбреЗрд▓ рдмрдирд╛рдЙрдиреБ рднрдпреЛ, рд░ рдореЛрдбреЗрд▓ рдЧреБрдгрд╕реНрддрд░рд▓рд╛рдИ 97% рд╕рдореНрдо рд╕реБрдзрд╛рд░реНрдиреБрднрдпреЛред Regression рдХреЛ рдЕрдиреНрддрд┐рдо рдЦрдгреНрдбрдорд╛, рддрдкрд╛рдИрдВрд▓реЗ Logistic Regression рдХреЛ рдмрд╛рд░реЗрдорд╛ рд╕рд┐рдХреНрдиреБ рд╣реБрдиреЗрдЫ рдЬреБрди рд╡рд░реНрдЧрд╣рд░реВ рдирд┐рд░реНрдзрд╛рд░рдг рдЧрд░реНрди рдкреНрд░рдпреЛрдЧ рд╣реБрдиреНрдЫред

---
## ЁЯЪАChallenge

рдпрд╕ рдиреЛрдЯрдмреБрдХрдорд╛ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рд╣рд░реВ рдкрд░реАрдХреНрд╖рдг рдЧрд░реЗрд░ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН рдХрд┐ рд╕рд╣рд╕рдВрдмрдиреНрдз рд░ рдореЛрдбреЗрд▓рдХреЛ рд╢реБрджреНрдзрддрд╛рдмреАрдЪ рдХрд╕реНрддреЛ рд╕рдореНрдмрдиреНрдз рд╣реБрдиреНрдЫред

## [рдкрд╛рда рдкреВрд░рд╛ рдЧрд░реЗ рдкрдЫрд┐рдХреЛ рдХреНрд╡рд┐рдЬ](https://ff-quizzes.netlify.app/en/ml/)

## рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рд░ рдЖрддреНрдо-рдЕрдзреНрдпрдпрди

рдпрд╕ рдкрд╛рдардорд╛ рд╣рд╛рдореАрд▓реЗ Linear Regression рд╕рд┐рдХреНрдпреМрдВред Regression рдХрд╛ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рдХрд╛рд░рд╣рд░реВ рдкрдирд┐ рдЫрдиреНред Stepwise, Ridge, Lasso рд░ Elasticnet рдкреНрд░рд╡рд┐рдзрд┐рд╣рд░реВрдХреЛ рдмрд╛рд░реЗрдорд╛ рдкрдвреНрдиреБрд╣реЛрд╕реНред рдердк рдЕрдзреНрдпрдпрдирдХрд╛ рд▓рд╛рдЧрд┐ рд░рд╛рдореНрд░реЛ рдХреЛрд░реНрд╕ рд╣реЛ [Stanford Statistical Learning course](https://online.stanford.edu/courses/sohs-ystatslearning-statistical-learning)

## рдХрд╛рд░реНрдп 

[рдореЛрдбреЗрд▓ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН](assignment.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**рдЕрд╕реНрд╡реАрдХрд░рдг**:
рдпрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд▓рд╛рдИ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХреЛ рдорд╛рдзреНрдпрдордмрд╛рдЯ рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рд╢реБрджреНрдзрддрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпрд╛рд╕рд░рдд рдЫреМрдВ рднрдиреЗ рдкрдирд┐, рдХреГрдкрдпрд╛ рдЬрд╛рдирдХрд╛рд░ рд╣реБрдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛ рд╣реБрди рд╕рдХреНрдЫред рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬ рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛рдорд╛ рдиреИ рдЕрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдиреНрдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХрд╛ рд▓рд╛рдЧрд┐ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рд╣реБрдиреЗ рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рджреБрд░рд╡реНрдпрд╛рдЦреНрдпрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЙрддреНрддрд░рджрд╛рдпреА рдЫреИрдиреМрдВред
<!-- CO-OP TRANSLATOR DISCLAIMER END -->